\ProvidesPackage{python}

\RequirePackage[usenames,dvipsnames,svgnames,table]{xcolor}
\RequirePackage{listings}
\RequirePackage{relsize}
\RequirePackage{caption}
\RequirePackage{DejaVuSansMono}
\RequirePackage{calc}

\definecolor{BackgroundGreen}{HTML}{E6F0F0}
\definecolor{NoteBackground}{HTML}{FFFCE3}
\definecolor{BackgroundBeige}{HTML}{FDF6E3}
\definecolor{BackgroundYellow}{HTML}{FEFBDF}
\definecolor{SolarizedGrey}{HTML}{657B83}
\definecolor{CornellRed}{HTML}{B31B1B}
\definecolor{CppGold}{HTML}{b38000}
\definecolor{PythonBlue}{HTML}{3675a9}

\newlength{\charwidth}
\setlength{\charwidth}{\widthof{\smaller\ttfamily a}}

\DeclareCaptionFont{white}{\color{white}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Captions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\DeclareCaptionFormat{listing}{\colorbox[HTML]{3675a9}{\parbox{\dimexpr\textwidth-2\fboxsep\relax}{#1#2#3}}}
\captionsetup[PYTHON]{format=listing,labelfont=white,textfont=white, singlelinecheck=false, margin=0pt, font={bf,small}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Typesetting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Language Definition
\lstdefinelanguage{Python}{%
  % Basic settings
  basicstyle=\smaller\ttfamily,
  tabsize=4,
  showstringspaces=false,
  mathescape=true,
  breaklines=true,
  numbers=left,
  % Keywords, strings, and comments
  keywords={%
    and, del, from, not, while, as, elif, global, or, with, assert, else, if,
    pass, yield, break, except, import, print, class, exec, in, raise,
    continue, finally, is, return, def, for, lambda, try
  },
  keywords=[2]{%
    numpy, np, scipy, sp, plt
  },
  morestring=[b]",
  morestring=[b]',
  morecomment=[l]{\#},
  % Colors and style
  keywordstyle=\color{blue},
  keywordstyle=[2]\color{DarkOrchid},
  commentstyle=\color{ForestGreen},
  stringstyle=\color{Red},
  numberstyle=\color{SolarizedGrey}
}

% environment
\lstnewenvironment{Python}[1][]{%
  \lstset{language=Python, linewidth=80\charwidth, #1}
  \captionsetup{options=PYTHON}
}{}


% inline definition.
\newcommand*{\python}{\lstinline[{language=Python}]}

% input listing definition
\newcommand{\inputpython}[2][ ]{{%
  {%
  \captionsetup{options=PYTHON}
  \lstset{linewidth=80\charwidth}
  \lstinputlisting[language=Python,#1]{#2}
  }
}}
