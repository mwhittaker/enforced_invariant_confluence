\tikzstyle{point}=[shape=circle, fill=flatgray, inner sep=2pt]
\tikzstyle{inv}=[line width=0.75pt, draw=black]
\tikzstyle{pointinv}=[point, inv]
\tikzstyle{invregion}=[rounded corners, fill=flatgreen!50, draw=none]
\tikzstyle{reachableregion}=[rounded corners, fill=flatblue!50, draw=none]
\tikzstyle{statelabel}=[anchor=south west, inner sep=1pt]

% Quadrant 1.
\newcommand{\quadi}[5]{{
  \newcommand{\argstyle}{#1}
  \newcommand{\argxmin}{#2}
  \newcommand{\argxmax}{#3}
  \newcommand{\argymin}{#4}
  \newcommand{\argymax}{#5}
  \foreach \x in {0, ..., \argxmax} {
    \foreach \y in {0, ..., \argymax} {
      \node[\argstyle] (\x-\y) at (\x, \y) {};
    }
  }
}}

% Quadrant 2.
\newcommand{\quadii}[5]{{
  \newcommand{\argstyle}{#1}
  \newcommand{\argxmin}{#2}
  \newcommand{\argxmax}{#3}
  \newcommand{\argymin}{#4}
  \newcommand{\argymax}{#5}
  \foreach \x in {\argxmin, ..., 0} {
    \foreach \y in {0, ..., \argymax} {
      \node[\argstyle] (\x-\y) at (\x, \y) {};
    }
  }
}}

% Quadrant 3.
\newcommand{\quadiii}[5]{{
  \newcommand{\argstyle}{#1}
  \newcommand{\argxmin}{#2}
  \newcommand{\argxmax}{#3}
  \newcommand{\argymin}{#4}
  \newcommand{\argymax}{#5}
  \foreach \x in {\argxmin, ..., 0} {
    \foreach \y in {\argymin, ..., 0} {
      \node[\argstyle] (\x-\y) at (\x, \y) {};
    }
  }
}}

% Quadrant 4.
\newcommand{\quadiv}[5]{{
  \newcommand{\argstyle}{#1}
  \newcommand{\argxmin}{#2}
  \newcommand{\argxmax}{#3}
  \newcommand{\argymin}{#4}
  \newcommand{\argymax}{#5}
  \foreach \x in {0, ..., \argxmax} {
    \foreach \y in {\argymin, ..., 0} {
      \node[\argstyle] (\x-\y) at (\x, \y) {};
    }
  }
}}

\newcommand{\xmin}{-2}
\newcommand{\xmax}{2}
\newcommand{\ymin}{-2}
\newcommand{\ymax}{2}

\begin{figure}[ht]
  \centering

  \begin{subfigure}[b]{0.5\columnwidth}
    \centering
    \begin{tikzpicture}[scale=0.4]
      \begin{scope}
        \clip (\xmin.5, \ymax.5) rectangle (\xmax.5, \ymin.5);
        \draw[invregion] (\xmin.9, \ymax.9) rectangle (0.5, -0.5);
        \draw[invregion] (-0.5, 0.5) rectangle (\xmax.9, \ymin.9);
        \draw (0.5, 0.5) to (0.5, \ymax.5);
        \draw (0.5, 0.5) to (\xmax.5, 0.5);
        \draw (-0.5, -0.5) to (-0.5, \ymin.5);
        \draw (-0.5, -0.5) to (\xmin.5, -0.5);
      \end{scope}

      \draw[] (\xmin, 0) to (\xmax, 0);
      \draw[] (0, \ymin) to (0, \ymax);

      \quadi{point}{\xmin}{\xmax}{\ymin}{\ymax}
      \quadiii{point}{\xmin}{\xmax}{\ymin}{\ymax}
      \quadii{pointinv}{\xmin}{\xmax}{\ymin}{\ymax}
      \quadiv{pointinv}{\xmin}{\xmax}{\ymin}{\ymax}

      \node[statelabel] at (0, 0) {$s_0$};
      \node[statelabel] at (-1, 1) {$s_1$};
      \node[statelabel] at (1, -1) {$s_2$};
      \node[statelabel] at (1, 1) {$s_3$};
    \end{tikzpicture}
    \caption{Invariant}\figlabel{Z2Invariant}
  \end{subfigure}%
  \begin{subfigure}[b]{0.5\columnwidth}
    \centering
    \begin{tikzpicture}[scale=0.4]
      \begin{scope}
        \clip (-1, 1) rectangle (\xmax.5, \ymin.5);
        \draw[reachableregion, draw=black] (-0.5, 0.5) rectangle (\xmax.9, \ymin.9);
      \end{scope}

      \draw[] (\xmin, 0) to (\xmax, 0);
      \draw[] (0, \ymin) to (0, \ymax);

      \quadi{point}{\xmin}{\xmax}{\ymin}{\ymax}
      \quadiii{point}{\xmin}{\xmax}{\ymin}{\ymax}
      \quadii{point}{\xmin}{\xmax}{\ymin}{\ymax}
      \quadiv{pointinv}{\xmin}{\xmax}{\ymin}{\ymax}

      \node[statelabel] at (0, 0) {$s_0$};
      \node[statelabel] at (-1, 1) {$s_1$};
      \node[statelabel] at (1, -1) {$s_2$};
      \node[statelabel] at (1, 1) {$s_3$};
    \end{tikzpicture}
    \caption{Reachable points}\figlabel{Z2Reachable}
  \end{subfigure}

  \caption{An illustration of \exampleref{Z2}}\figlabel{Z2}
\end{figure}
