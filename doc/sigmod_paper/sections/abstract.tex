\begin{abstract}
Strongly consistent distributed systems are easy to reason about but face
fundamental limitations in availability and performance. Weakly consistent
systems can be implemented with very high performance but place a burden on the
application developer to reason about complex interleavings of execution.
\Invariantconfluence{} provides a formal framework for understanding when we
can get the best of both worlds. An \invariantconfluent{} object can be
efficiently replicated with no coordination needed to preserve its invariants.
However, actually determining whether or not an object is \invariantconfluent{}
is challenging.

In this paper, we establish conditions under which a commonly used sufficient
condition for \invariantconfluence{} is both necessary and sufficient, and we
use this condition to design a general-purpose interactive
\invariantconfluence{} decision procedure. We then take a step beyond
\invariantconfluence{} and introduce a generalization of
\invariantconfluence{}, called segmented \invariantconfluence{}, that allows us
to replicate non-\invariantconfluent{} objects with a small amount of
coordination. We implement these formalisms in a prototype called Lucy and
find that our decision procedures efficiently handle common real-world
workloads including foreign keys, escrow transactions, and more.
\end{abstract}
