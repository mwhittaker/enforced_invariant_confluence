\begin{figure}[ht]
  \centering

  \tikzstyle{s0color}=[fill=flatred]
  \tikzstyle{s1color}=[fill=flatgreen]
  \tikzstyle{s2color}=[fill=flatdenim]
  \tikzstyle{s3color}=[fill=flatorange]
  \tikzstyle{s4color}=[fill=flatyellow]
  \tikzstyle{s5color}=[fill=flatcyan]
  \tikzstyle{s6color}=[fill=flatpurple]
  \tikzstyle{s7color}=[fill=flatblue]
  \tikzstyle{s8color}=[fill=flatdarkgray]
  \tikzstyle{txnline}=[black, thick, ->]

  \begin{subfigure}[c]{0.5\textwidth}
    \centering

    \begin{tikzpicture}[xscale=2, yscale=2]
      \node (p3) at (0.5, 3) {$p_3$};
      \node (p2) at (0.5, 2) {$p_2$};
      \node (p1) at (0.5, 1) {$p_1$};

      \tikzstyle{pline}=[gray, opacity=0.5, thick, ->]
      \draw[pline] (p3) to (5.5, 3);
      \draw[pline] (p2) to (5.5, 2);
      \draw[pline] (p1) to (5.5, 1);

      \node[state, s0color, inv, label={90:$s_0$}] (s03) at (1, 3) {};
      \node[state, s1color, inv, label={90:$s_1$}] (s13) at (2, 3) {};
      \node[state, s3color, inv, label={90:$s_3$}] (s23) at (3, 3) {};
      \node[state, s6color, inv, label={90:$s_6$}] (s33) at (4, 3) {};



      % \node[state, s1color, inv, label={90:$s_1$}] (s13) at (2, 3) {};
      % \node[state, s3color, inv, label={90:$s_3$}] (s23) at (3, 3) {};
      % \node[state, s6color, inv, label={90:$s_6$}] (s33) at (4, 3) {};

      \node[state, s0color, inv, label={90:$s_0$}] (s02) at (1, 2) {};
      \node[state, s2color, inv, label={90:$s_2$}] (s12) at (2, 2) {};
      \node[state, s4color, inv, label={90:$s_4$}] (s22) at (3, 2) {};
      \node[state, s7color, ninv, label={90:$s_7$}] (s32) at (4, 2) {};
      % \node[state, s2color, inv, label={90:$s_2$}] (s12) at (2, 2) {};
      % \node[state, s4color, inv, label={90:$s_4$}] (s22) at (3, 2) {};

      \node[state, s0color, inv, label={90:$s_0$}] (s01) at (1, 1) {};
      \node[state, s2color, inv, label={90:$s_2$}] (s11) at (2, 1) {};
      \node[state, s5color, inv, label={90:$s_5$}] (s21) at (3, 1) {};
      \node[state, s8color, inv, label={90:$s_8$}] (s31) at (4, 1) {};
      % \node[state, s2color, inv, label={90:$s_2$}] (s11) at (2, 1) {};
      % \node[state, s5color, inv, label={90:$s_5$}] (s21) at (3, 1) {};
      % \node[state, s7color, ninv, label={90:$s_7$}] (s31) at (5, 1) {};

      \tikzstyle{txntext}=[sloped, above]
      \tikzstyle{sendline}=[opacity=0.1, gray]
      \draw[txnline] (s03) to node[txntext]{$t(s_0)$} (s13);
      \draw[txnline, sendline] (s03) to node[txntext]{} (s22);
      \draw[txnline, sendline] (s03) to node[txntext]{} (s31);

      \draw[txnline, sendline] (s02) to node[txntext]{} (s23);
      \draw[txnline] (s02) to node[txntext]{$u(s_0)$} (s12);
      \draw[txnline, sendline] (s02) to node[txntext]{} (s11);

      \draw[txnline, sendline] (s11) to node[txntext]{} (s33);
      \draw[txnline, sendline] (s11) to node[txntext]{} (s32);
      \draw[txnline] (s11) to node[txntext]{$v(s_2)$} (s21);

      \draw[txnline] (s13) to node[txntext]{$u(s_0)$} (s23);
      \draw[txnline] (s23) to node[txntext]{$v(s_2)$} (s33);

      \draw[txnline] (s12) to node[txntext]{$t(s_0)$} (s22);
      \draw[txnline] (s22) to node[txntext]{$v(s_2)$} (s32);

      \draw[txnline] (s01) to node[txntext]{$u(s_0)$} (s11);
      \draw[txnline] (s21) to node[txntext]{$t(s_2)$} (s31);

      % \draw[txnline] (s03) to node[txntext]{$t$} (s13);
      % \draw[txnline] (s13) to node[txntext]{$v$} (s23);
      % \draw[txnline] (s02) to node[txntext]{$u$} (s12);
      % \draw[txnline] (s01) to node[txntext]{$u$} (s11);
      % \draw[txnline] (s11) to node[txntext]{$w$} (s21);
      %
      % \draw[txnline] (s13) to node[txntext]{} (s22);
      % \draw[txnline] (s12) to node[txntext]{} (s22);
      % \draw[txnline] (s22) to node[txntext]{} (s33);
      % \draw[txnline] (s23) to node[txntext]{} (s33);
      % \draw[txnline] (s21) to node[txntext]{} (s31);
      % \draw[txnline] (s33) to node[txntext]{} (s31);
    \end{tikzpicture}

    \caption{}\figlabel{}
  \end{subfigure}

  \caption{}\figlabel{}
\end{figure}
